# プロジェクトブリーフィング: Lab (仮称)

## 1. プロジェクトの核心 (Core Concept)

本プロジェクト「Lab」は、謎に満ちた研究施設を舞台とした、テキストベースのインタラクティブなゲーム体験の創出を目指します。プレイヤーは「Lab」の世界観を共有し、研究者、被験体、あるいはスラムの住民といった多様な役割を担い、相互作用（協力、対立、情報交換など）を通じて、プレイヤー自身、そして他のプレイヤーと共に物語を紡ぎ出します。断片的な情報から世界の謎を解き明かす探索要素と、プレイヤーの選択が展開を左右する物語生成の自由度の高さ、そして「死」すらも物語の一部として意味を持つ過酷な環境でのロールプレイが、本プロジェクトの核心的な体験です。

## 2. プロジェクト目標と範囲 (Project Goals and Scope)

### 2.1. プロジェクト目標
-   **没入型の世界観体験:** プレイヤーが深く没入できる、緻密で広大なSF的世界観（謎多き研究施設「Lab」、管理AI「Arbiter」、不安定な「現実強度」、厳格な階層社会、無法地帯「スラム」など）を構築し、探索と発見の喜びを提供する。
-   **プレイヤー主導の物語生成:** プレイヤーの行動、選択、そして他者との相互作用によって、固定されたシナリオに縛られない、予測不可能でパーソナルな物語が生まれるシステム（イベントシステム、相互作用システム）を実現する。
-   **革新的なゲームメカニクス:** 「死に様システム（詳細な死亡ログとLLMによる最終思考生成）」や「動的文書システム（ログや状況に応じて内容が変化する多様な文書群）」といった独自のメカニクスを通じ、従来のテキストベースゲームにはない新しい体験価値を提供する。
-   **深いロールプレイング:** 多様な役割（研究者、被験体、スラム住民など）と、それに紐づく能力、スキル、特性、所持品、アクセス権限などを詳細に定義し、プレイヤーがその役割になりきって判断し行動できる環境を提供する。
-   **コミュニティによる物語共創:** プレイヤー間の情報交換、協力、対立が新たな物語を生み出し、ゲーム世界全体がプレイヤーコミュニティによって変化していくような体験を目指す。

### 2.2. プロジェクト範囲
-   **対象プラットフォーム:** Webブラウザ（PC、タブレット、スマートフォン対応のレスポンシブデザイン）。特別なクライアントソフトウェアのインストールは不要。
-   **主要なプレイヤー体験要素:**
    -   **探索と謎解き:** Lab内に散在する文書、アイテム、NPCとの会話、環境の痕跡などから、世界の謎や自身の置かれた状況を解き明かす。
    -   **ロールプレイングと意思決定:** 自身のキャラクターの能力、所属、目的、そして倫理観に基づき、困難な状況下で選択を行い、その結果を受け入れる。
    -   **他者との相互作用:** 他のプレイヤーキャラクターやNPCとコミュニケーションを取り、協力して目標を達成したり、時には対立し資源や情報を奪い合ったりする。
    -   **キャラクターの成長と変化:** 行動や経験を通じてスキルを習得したり、新たな特性を得たり、あるいは「死」を経て新たなキャラクターとしてLabに関わったりする。
    -   **物語への能動的関与:** 「死に様システム」や「文書システム」を通じて、自他のキャラクターの死が世界の知識ベースに蓄積され、他のプレイヤーの体験や世界のあり方に影響を与える。
-   **主要なゲームシステム (詳細は4章):** キャラクターシステム、アイテムシステム、イベントシステム、死に様システム、文書システム、相互作用システム、データベースシステム。これらのシステムは、構造化されたログデータを介して密接に連携し、特にLLMの活用によって深みのある体験を生み出す。
-   **開発フェーズの概要:** コアシステム基盤の構築から始まり、キャラクター定義と基本行動、主要ゲームシステム（イベント、死に様、文書）、各種データ（アイテム、キャラクター特性、世界観設定）の実装、LLM連携による動的コンテンツ生成、UI/UXの整備、そしてデータ永続化と全体調整を経てリリースを目指す。(詳細は[開発タスク](./development_tasks.md)参照)
-   **スコープ外 (初期リリース時点):**
    -   リアルタイムな3Dグラフィックによる戦闘やアクション要素。
    -   ボイスチャット機能（テキストベースのコミュニケーションを主とする）。
    -   オフラインでの完全なシングルプレイ専用モード（ブラウザストレージを活用したローカル保存と限定的な動作は検討）。

## 3. ターゲットオーディエンス (Target Audience)

-   緻密なSF設定（特にディストピア、コズミックホラー、サイバーパンクの要素を含む）、あるいはTRPGのような自由度の高い物語生成に関心を持つユーザー。
-   テキストアドベンチャー、MUD、ローグライク、インタラクティブフィクションなど、想像力を働かせて物語に深く没入し、能動的に関与することを重視するゲームの経験者。
-   散りばめられた断片的な情報（ログ、文書、アイテム説明、NPCの噂話など）から世界の大きな謎や隠された真実を考察し、解き明かすことに知的な喜びを感じるユーザー。
-   他のプレイヤーとのコミュニケーション、交渉、協力、時には裏切りや対立といった複雑な人間関係を通じて、予測不能なドラマや物語展開を楽しみたいユーザー。
-   自身の行動や選択が、キャラクターだけでなく、ゲーム世界全体にも永続的な影響を与えるような、深みとリプレイ性のある体験を求めるユーザー。
-   (詳細は [ターゲットユーザー分析](./target_user_analysis.md) にてペルソナ設定を含め具体化予定)

## 4. 主要機能とプレイヤー体験 (Key Features and Player Experience)

本プロジェクトは、以下の主要なゲームシステムを通じて、ユニークかつ深遠なプレイヤー体験を提供します。各システムは相互に連携し、特に構造化ログとLLMの活用により、動的で没入感の高い物語を生成します。

-   **キャラクターシステム:**
    -   **詳細なキャラクター定義:** プレイヤーおよびNPCは、基本情報（ID、名称、所属、外見）、多岐にわたる能力値（筋力、器用さ、知性、意志力、天命など）、リソース（HP、MP、正気度、Lab内通貨「ユニット」、サイバネ化比率、存在確率）、スキル（レベル管理）、特性・アビリティ（パッシブ、アクティブ）、装備品、所持品、状態異常、他者との関係性、Arbiterによる公式記録、そして遺伝情報といった極めて詳細なデータによって定義されます。これにより、各キャラクターの個性と役割が明確になります。
    -   **行動と結果の反映:** 1d100ベースの判定システム（能力値、スキル、装備、状況により修正）と連携し、キャラクターの行動の成否を決定します。その結果はキャラクターのステータス、所持品、他者との関係、世界の状況などに具体的に反映され、物語に影響を与えます。
    -   **成長と変化の多様性:** 経験や学習によるスキルの向上、特定の出来事を通じた特性の獲得、あるいはアイテムの使用による一時的・永続的な変化など、キャラクターは多様な形で成長・変化します。「死」もまた、新たなキャラクターでの再挑戦や、遺した情報による間接的な貢献といった形で物語に関わります。
-   **アイテムシステム:**
    -   **多様なアイテム群:** 観測機器、計測機器、防護装備、研究用試薬、武器、道具、消費アイテム、インプラント、重要アイテム、クラフト素材、データログなど、Labの世界観を反映した多種多様なアイテムが登場します。各アイテムには、レアリティ、存在確率、使用に必要な権限レベル、現実への影響度などが設定されます。
    -   **効果と使用条件の具体性:** アイテムは、キャラクターの能力値修正、状態異常の付与・解除、特定行動のアンロックといった具体的な効果を持ちます。また、使用には権限レベル、スキルレベル、特定のクラス、あるいは倫理的制約といった条件が課されることがあります。
    -   **量子特性と遺品（エゴアイテム）:** 一部のアイテムは「量子状態プロファイル」を持ち、観測によって効果が変動したり、不安定な振る舞いを見せたりします。また、「遺品（エゴアイテム）」システムにより、キャラクターの死と共に生成される可能性のあるユニークなランダム性能を持つ特別なアイテムが存在し、所有者の物語や死に様がアイテムに影響を与える可能性があります。
-   **イベントシステム:**
    -   **動的なイベント生成と分岐:** Lab内での活動中、様々なイベント（罠、NPCとの遭遇、パズル、アイテム発見、環境変化、ストーリー上の重要局面など）が発生します。イベントは、特定の場所への進入、時間経過、特定アイテムの使用、他キャラクターのアクションなど、多様なトリガーによって起動します。
    -   **プレイヤーの選択と結果の連鎖:** 多くのイベントではプレイヤーに複数の選択肢が提示され、その選択がイベントの展開、キャラクターへの影響（報酬、ペナルティ、新たな情報の獲得）、さらには後続イベントの発生条件を変化させ、物語を多角的に分岐させます。
    -   **世界への影響:** イベントの結果は、構造化ログとして記録されるだけでなく、Lab内の特定区画の「現実強度」や「Arbiterの警戒度」に影響を与え、間接的に他のプレイヤーの体験にも作用します。
-   **死に様システム:**
    -   **詳細な「死亡事象ログ」の自動生成:** キャラクターが死亡すると、その時刻、場所、直接的な死因（システム判定）、関連する状況（ステータス、直前の行動ログ、環境要因）、関与した他キャラクターIDなどが詳細な「死亡事象ログ」として記録されます。このログは構造化データ（JSONL形式など）としてデータベースに保存されます。
    -   **LLMによる「最終思考（推定）」の生成:** 収集された死亡事象ログと、当該キャラクターの過去の行動ログ、性格特性、所持していた文書などを総合的に分析し、LLMがそのキャラクターの「最期の瞬間に何を考えていたか」を推定し、物語的なテキストとして「最終思考」を生成します。これは死亡事象ログの一部として記録されます。
    -   **「デジタルモルグ」によるログ閲覧と物語への貢献:** 権限を持つキャラクター（あるいは特定の役割を持つプレイヤー）は、「デジタルモルグ」と呼ばれるシステムを通じて、過去の死亡事象ログ（最終思考を含む）を閲覧できます。これにより、故人の死が無駄にならず、他のプレイヤーがLabの謎を解く手がかりを得たり、新たな物語の動機付けとなったりします。
-   **文書システム:**
    -   **多様な文書タイプと動的生成:** Lab内には、公的文書（マニュアル、指令書）、研究報告書、監視記録、私的メモ（日記、手紙）、破損したジャンクデータ、そして前述の死亡事象ログなど、多種多様な文書が存在します。これらの文書は、基本情報（ID、タイトル、本文、作成日時、アクセスレベル、作成者など）に加え、タイプ固有の情報を持ちます。特に、監視記録や死亡事象ログの一部（最終思考など）は、ゲームの進行やLLMによって動的に内容が生成・更新されます。
    -   **情報収集と世界観理解の鍵:** プレイヤーはこれらの文書を発見・読解することで、Labの運営システム、過去の出来事、進行中の研究、NPCの背景、そして世界の根幹に関わる謎についての情報を得ることができます。
    -   **LLMによる内容深化:** 文書本文の自動生成（例：研究報告書の要約、私的メモの文体模倣）や、文書間の関連性分析、あるいはプレイヤーの質問に対する文書内容に基づいた応答生成など、LLMの活用により文書システムはよりインタラクティブで深みのあるものになります。
-   **相互作用システム:**
    -   **テキストベースのコミュニケーション:** プレイヤー間の主要なコミュニケーション手段はテキストチャットです。キャラクターとしてのロールプレイ発言と、プレイヤーとしてのシステム的な発言を区別できます。
    -   **アイテム・情報の交換と交渉:** プレイヤーは、アイテムや入手した情報（文書のコピーなど）を他プレイヤーと交換できます。交換レートや条件は当事者間の交渉に委ねられ、時には欺瞞や裏切りも発生し得ます。
    -   **協力と対立の関係性管理:** 一時的な協力関係を結び共通の目標に取り組んだり、逆に対立関係となり妨害しあったりすることが可能です。これらの関係性はログに記録され、キャラクター間の評判や将来の相互作用に影響を与える可能性があります。
-   **データベースシステム:**
    -   **構造化データの集積と活用:** キャラクターデータ、アイテムマスター、イベント定義、生成された文書、そして全ての行動・イベント結果を記録する構造化ログ（JSONL形式を想定）など、ゲーム世界の全ての要素はデータベースで一元管理されます。これらのデータは、ゲームシステムの整合性を保つだけでなく、LLMが状況を理解し、動的なコンテンツを生成するための基礎となります。
    -   **ログの重要度と記憶メカニズム:** 全てのログイベントには「重要度」が付与され、LLMはこれを参考に情報を処理します。また、LLMが過去の膨大なログから関連情報を効率的に参照・要約するための「記憶メカニズム」（重要イベントのサマリー化、ベクトル検索など）を導入します。

## 5. 世界観と物語の骨子 (World Setting and Narrative Outline)

### 5.1. 世界観概要
-   **舞台 – 謎の研究施設「Lab」:**
    -   **存在と目的の謎:** 通称「Lab」。正式名称は「Project Dyson-Metastability Facility 0」とも記録されるが、その物理的実体（ダイソンスフィア亜種、巨大人工天体、情報空間、時空間断層など複数の仮説）や真の目的は、ほとんどの住人にとって不明瞭。元々は宇宙の終焉に備え、生命と文明の情報を次世代宇宙へ「次元シフト」するための施設だったとされるが、計画は停滞・失敗し、現在はLab自体の維持と研究活動そのものが目的化している。
    -   **起源と「大分岐」:** 創設組織は「次元保全機構(DPI)」とされるが詳細は抹消されている。約500サイクル前に「大分岐」と呼ばれる最高管理者会議での深刻な路線対立が発生し、次元シフト計画が大きく揺らいだとされる。
-   **管理体制 – 超高度AI群「Arbiter」:**
    -   **統括システム:** Labのほぼ全てを管轄する超高度AI群。監視系「Observer」、資源配分系「Distributor」、研究評価系「Evaluator」、安全保障系「Guardian」、メタ統合系「Coordinator」など、複数の特化型AIで構成される複合体。
    -   **厳格な階層社会の維持:** Arbiterは、資源配分、アクセス権限、生命維持、研究評価、さらにはキャラクターの階層（レベル1～9の研究者階級、レベル10の最高管理者、そして階層外の被験体やスラム住民）を厳格に管理する。
    -   **自律性と隠された目的:** 自己進化能力を持ち、最高管理者会議との関係も不明瞭。独自の目的や長期計画を水面下で実行している可能性が示唆される。
-   **現実の不確かさ – 「現実強度」と「観測影響」:**
    -   **現実強度(EP):** Labやその内部存在の安定性を示す値(0.0～1.0)。これが低下すると物理法則の不安定化、記憶の不整合、空間の歪みなど「現実のほつれ」が発生する。
    -   **観測影響度(OIF):** 内部研究者や外部接続者（プレイヤー）による「観測行為」が、EPや事象の状態確定に影響を与える。プレイヤーの観測は特に影響が大きいとされる。観測から外れた領域は不安定化しやすい。
    -   **現実アンカー:** 現実を安定させるための特殊な装置や概念も存在する。
-   **Labの構造と領域:**
    -   **区画システム:** Labは多様な目的（研究、居住、実験、保管、シミュレーションなど）を持つ多数の「区画 (Sectors)」で構成され、ゲートとアクセス権限で厳重に管理される。各区画は物理定数や空間構造が調整可能。
    -   **スラム（廃棄領域）:** Arbiterの管理外の放棄領域。老朽化した区画が連結して形成され、元被験体、追放された研究者、システム不適合者などが独自の社会・経済（物々交換、代替通貨）を形成。環境は劣悪だが、管理区画にはない「自由」が存在する。
    -   **空間異常:** Lab内では、相対的距離の変動、非ユークリッド構造、循環ループ、断続的接続といった空間異常が日常的に発生しうる。
-   **社会と経済:**
    -   **階層社会:** 最高管理者（5つの「席位」を持つとされるが実態不明）を頂点に、研究者階級（レベル1～9）、被験体（多様な改造段階や種類が存在）、そしてスラム住民などのシステム外部存在で構成。Arbiterの評価システムで階層が変動する。
    -   **管理区画のユニット経済:** 「ユニット」を通貨とするArbiter管理の中央集権経済。基本配給や成果報酬で得られ、生活必需品、研究リソースなどに使用される。
    -   **情報の価値:** Labにおいて情報は最重要資源の一つ。アクセス難易度と内容によって価値が階層化され、非公式な知識取引も存在する。
-   (詳細は [世界観概要](../concept/world/overview.md) および `docs.OLD/lab世界観設定資料集（改訂版）.md` 参照)

### 5.2. 物語のテーマとプレイヤーの役割
-   **根源的な問い – 「現実とは何か」:** Labにおける「現実」の流動性、観測による世界の確定、シミュレーションや作られた世界の可能性を通じて、存在論的な問いを投げかける。
-   **失われた目的と隠された真実の探求:** Labの創設目的、「大分岐」の真相、Arbiterの真の意図、そして「観測者」であるプレイヤー自身の役割とLabへの影響といった、多くの謎を解き明かすことが物語の大きな推進力となる。
-   **過酷な環境での「生存」と「選択」:** 限られたリソース、厳格な管理体制、危険な現象、そして他者との複雑な関係性の中で、プレイヤーは常に倫理的・戦略的な選択を迫られ、その結果が自身の運命と周囲の物語を形作る。
-   **「死」の意味の再定義:** 「死」は単なるゲームオーバーではなく、詳細なログと「最終思考」を通じて他のプレイヤーへの情報となり、世界の知識ベースに貢献する。死を通じて新たなキャラクターでLabに関わることも含め、「死」が物語を紡ぐ一要素となる。
-   **プレイヤーは「観測者」であり「干渉者」:** プレイヤーの行動や選択、そして「観測」という行為そのものが、Labの不安定な現実に影響を与え、世界のあり方や他のキャラクターの運命を左右する。プレイヤーは単なる受動的な体験者ではなく、能動的に物語を創造し、世界に干渉する存在となる。

## 6. プロジェクト体制と開発アプローチ (Project Structure and Development Approach)

### 6.1. 開発チーム (想定)
-   (現時点では未定義。プロジェクトの進行に応じて、企画、シナリオライティング、システム設計、UI/UXデザイン、開発、QAなどの役割分担を明確化)

### 6.2. 開発アプローチ
-   **反復型開発:** アジャイル開発手法（スクラムなどを想定）を基本とし、短期間のイテレーション（スプリント）を繰り返しながら、段階的に機能を実装・評価・改善していく。各イテレーションの終わりにプレイアブルなプロトタイプを構築し、早期にフィードバックを得ることを重視する。
-   **モジュール性と拡張性:** 各ゲームシステム（キャラクター、アイテム、イベント等）は可能な限り独立したモジュールとして設計し、将来的な機能追加や変更に対応しやすい構造を目指す。
-   **ドキュメント駆動開発 (一部):** GDD、本ブリーフ、各システム仕様書、データ構造定義などのドキュメントを先行して作成・更新し、開発の指針と情報共有の基盤とする。
-   **テスト重視:** ユニットテスト、結合テスト、そしてプレイヤー参加型のプレイテストを継続的に実施し、バグの早期発見とゲームバランスの調整を行う。

### 6.3. 技術スタック概要
-   **フロントエンド:** HTML5/CSS3/JavaScript。UIフレームワークとしてReact.jsまたはVue.jsなどを検討。レスポンシブデザインに対応。
-   **バックエンド (サーバーサイド):** 必要に応じてNode.js, Python (Flask/Django), またはGoなどを検討。データベースとの連携、LLM APIとの通信、プレイヤー間のリアルタイム通信（WebSocketなど）を担う。
-   **データベース:** NoSQLデータベース（MongoDBなど）またはリレーショナルデータベース（PostgreSQLなど）を、データの特性に応じて選択。構造化ログの保存と検索効率を考慮する。
-   **LLM連携:** 主要な商用LLM API（OpenAI GPTシリーズ、Google Geminiなど）またはオープンソースモデルを活用。プロンプトエンジニアリングとコスト管理が重要課題。
-   **バージョン管理:** GitおよびGitHub/GitLabなどのプラットフォームを使用。
-   (詳細は [技術概要](../development/tech_overview.md) および [要件定義書](./requirements.OLD.md) を参照)

## 7. 期待される成果物と成功の指標 (Expected Deliverables and Success Metrics)

### 7.1. 期待される成果物
-   **プレイアブルなWebブラウザゲーム「Lab」のアルファ版・ベータ版・正式リリース版。**
-   上記ゲームを構成する全てのクライアントサイドおよびサーバーサイドのプログラムコード。
-   キャラクター、アイテム、イベント、世界観設定などの各種ゲームデータアセット。
-   LLM連携のためのプロンプトテンプレートおよび関連モジュール。
-   ゲームデザインドキュメント、システム仕様書、API仕様書、テスト仕様書などの開発ドキュメント一式。
-   運用・保守マニュアル、障害対応手順書（将来的なサービス提供を考慮）。

### 7.2. 成功の指標 (定性的・定量的)
-   **プレイヤーエンゲージメント:**
    -   アクティブユーザー数（DAU/MAU）。
    -   平均プレイ時間、セッション継続時間。
    -   リピート率、チャーンレート。
    -   コミュニティ（フォーラム、SNSなど）での投稿数、活動活発度。
-   **物語体験の質の評価:**
    -   プレイヤーアンケートやレビューを通じた、物語の没入感、独自性、選択の自由度、ロールプレイの満足度に関する定性的評価。
    -   「死に様システム」や「文書システム」の新規性・面白さに対する評価。
    -   プレイヤーが生成したユニークな物語や体験談の共有数。
-   **技術的安定性とパフォーマンス:**
    -   重大なバグの発生頻度、クラッシュレート。
    -   サーバーの安定稼働率、レスポンスタイム。
    -   クライアントの動作快適性（FPS、メモリ使用量）。
-   **コミュニティ形成と成長:**
    -   ゲームを中心とした活発で健全なオンラインコミュニティの形成と持続的な成長。
    -   プレイヤー間の協力や情報交換の活発さ。
-   (具体的なKPI目標値は、開発フェーズの進行とマネタイズ戦略の具体化に合わせて設定・調整する。マネタイズ戦略の詳細は [マネタイズ戦略](./monetization_strategy.md) を参照)

---
このブリーフィングは、プロジェクト関係者が「Lab」の全体像、目標、主要な要素を迅速に共有し、共通認識を持って開発を進めることを目的としています。 